<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MAMAG - Welcome</title>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Acme&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lobster+Two:ital,wght@0,400;0,700;1,400;1,700&family=Tomorrow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">  
  <link rel="stylesheet" href="style.css">
  <!-- <style>@view-transition { navigation: auto; }</style> -->
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
    let scrollRequest;
    let isAutoScrolling = false;
    const SCROLL_SPEED = 5; // Increase this number to go faster

    function step() {
        window.scrollBy(0, SCROLL_SPEED);

        // Check if we reached the bottom (with a 2px buffer for safety)
        if ((window.innerHeight + window.scrollY) < document.body.scrollHeight - 2) {
            scrollRequest = requestAnimationFrame(step);
        } else {
            stopAutoScroll();
        }
    }

    function stopAutoScroll() {
        if (!isAutoScrolling) return;
        cancelAnimationFrame(scrollRequest);
        isAutoScrolling = false;
        
        // Clean up listeners
        window.removeEventListener('wheel', stopAutoScroll);
        window.removeEventListener('touchmove', stopAutoScroll);
        window.removeEventListener('keydown', stopAutoScroll);
    }

    const startBtn = document.getElementById('startScroll');
    if (startBtn) {
        startBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();

            if (isAutoScrolling) {
                stopAutoScroll();
                return;
            }

            isAutoScrolling = true;
            scrollRequest = requestAnimationFrame(step);

            // Stop if user tries to take over
            window.addEventListener('wheel', stopAutoScroll, { passive: true });
            window.addEventListener('touchmove', stopAutoScroll, { passive: true });
            window.addEventListener('keydown', stopAutoScroll);
        });
    }
});
  </script>
 </head>
 <body>
<!-- Loading Screen -->
  <div class="loading-screen" id="loadingScreen">
   <div class="loading-content">
    <!-- <div class="loading-logo" id="loadingLogo">
     MAMAG!
    </div> -->
    <div class="loading-spinner"></div>
   </div>
  </div>
  <!-- Main Content -->

  <div class="main-content" id="mainContent">
   <header id="navbar">
    <div class="contc nav-left" >+ Contact Us</div>
    <div class="logo-container">
     <div class="logo" id="headerLogo">MAMAG!</div>
    </div>
    <div class="nav-right">
    <button class="icon-btn">
      <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <rect x="5" y="8" width="14" height="11" rx="2" /> 
        <path d="M9 8V6a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" />
     </svg>
    </button> 

    

    <button class="icon-btn">
      <svg viewbox="0 0 24 24" fill="none" stroke="currentColor">
       <line x1="3" y1="12" x2="21" y2="12" /><line x1="3" y1="6" x2="21" y2="6" /><line x1="3" y1="18" x2="21" y2="18" />
      </svg>
    </button> 


    <button class="icon-btn">
      <svg viewbox="0 0 24 24" fill="none" stroke="currentColor">
       <circle cx="11" cy="11" r="8" /><path d="M21 21l-4.35-4.35" />
      </svg>
    </button>


    

    <!-- <button class="icon-btn">
      <svg viewbox="0 0 24 24" fill="none" stroke="currentColor">
       <line x1="3" y1="12" x2="21" y2="12" /><line x1="3" y1="6" x2="21" y2="6" /><line x1="3" y1="18" x2="21" y2="18" />
      </svg>
    </button> -->

    </div>

    
    
   </header>
   <section class="hero"><img src="img/hero1 (2).jpg" class="hero-img" alt="Hero Image">
    <div class="hero-content">
     <!-- <h2 class="hero-title" id="heroTitle">New In</h2> -->
     <div class="btn-group">
        <button class="gucci-btn" id="startScroll">EXPLORE</button>
     </div>
    </div>
   </section>
   <div class="updates-section">
    <h2 class="section-title">Latest Updates</h2>

    <div class="status-container">

     <div class="status-card" data-status="0"><img src="https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Update 1" class="status-image">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div>
      <div class="status-name" id="status1Name">
       Spring Collection - ₦1,299
      </div>
     </div>

     <div class="status-card" data-status="1"><img src="https://images.unsplash.com/photo-1539533018447-63fcce2678e3?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Update 2" class="status-image">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div>
      <div class="status-name" id="status2Name">
       Summer Essentials - ₦1,299
      </div>
     </div>

     <div class="status-card" data-status="2"><img src="https://images.unsplash.com/photo-1483985988355-763728e1935b?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Update 3" class="status-image">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div>
      <div class="status-name" id="status3Name">
       Limited Edition - ₦1,299
      </div>
     </div>

     <div class="status-card" data-status="3"><img src="https://images.unsplash.com/photo-1469334031218-e382a71b716b?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Update 4" class="status-image">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div>
      <div class="status-name" id="status4Name">
       New Arrivals - ₦1,299
      </div>
     </div>

      <div class="status-card" data-status="4"><img src="https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Update 5" class="status-image">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div>
      <div class="status-name" id="status5Name">
       Spring Collection - ₦1,299
      </div>
     </div>

     <div class="status-card" data-status="5"><img src="https://images.unsplash.com/photo-1539533018447-63fcce2678e3?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Update 6" class="status-image">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div>
      <div class="status-name" id="status6Name">
       Summer Essentials - ₦1,299
      </div>
     </div>

     <div class="status-card" data-status="6"><img src="https://images.unsplash.com/photo-1483985988355-763728e1935b?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Update 7" class="status-image">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div>
      <div class="status-name" id="status7Name">
       Limited Edition - ₦1,299
      </div>
     </div>

     <div class="status-card" data-status="7"><img src="https://images.unsplash.com/photo-1469334031218-e382a71b716b?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Update 8" class="status-image">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div>
      <div class="status-name" id="status8Name">
       New Arrivals - ₦1,299
      </div>
     </div>

    </div>
   </div>
   <!-- Full Screen Status Viewer -->
   <div class="status-viewer" id="statusViewer">
    <button class="close-btn" id="closeBtn">
     <svg viewbox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18" /> <line x1="6" y1="6" x2="18" y2="18" />
     </svg>
    </button>
    <div class="status-fullscreen">
      <div class="progress-container"></div>
      <img src="" alt="Status" id="fullscreenImage" class="fullscreen-image">
     <div class="status-header">
      <div class="status-avatar-ring">
       <div class="status-avatar">
        MG
       </div>
      </div><span class="status-username" id="fullscreenName">Spring Collection ₦1,299</span>
     </div>
     <div class="interaction-sidebar">
    <button class="interaction-btn" id="likeBtn">
       <svg viewbox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
       </svg>
       <span class="interaction-label">Like</span> 
    </button> 
    <button class="interaction-btn" id="shareBtn">
       <svg viewbox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <circle cx="18" cy="5" r="3" /> <circle cx="6" cy="12" r="3" /> 
        <circle cx="18" cy="19" r="3" /> 
        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49" /> 
        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49" />
       </svg>
       <span class="interaction-label">Share</span> 
    </button> 
    <button class="interaction-btn" id="saveBtn" style="display: none;">
       <svg viewbox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
        <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" />
       </svg>
       <span class="interaction-label">Save</span> 
    </button>
     </div>
     <button class="order-btn" id="orderBtn">
      <span class="order-label">Order Now</span> 
    </button>
    </div>
   </div>
   <!-- New Arrivals Section -->
   <div class="arrivals-section">
    <h2 class="arrivals-title">New Arrivals</h2>
    <div class="arrivals-grid">
     <div class="product-card tall">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1591047139829-d91aecb6caea?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product 1" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Leather Handbag</h3>
       <p class="product-price">₦1,299</p>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1624623278313-a930126a11c3?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product 2" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Silk Scarf</h3>
       <p class="product-price">₦450</p>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1551107696-a4b0c5a0d9a2?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product 3" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Designer Sunglasses</h3>
       <p class="product-price">₦599</p>
      </div>
     </div>
     <div class="product-card wide">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1460353581641-37baddab0fa2?auto=format&amp;fit=crop&amp;q=80&amp;w=1200" alt="Product 4" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Evening Dress</h3>
       <p class="product-price">₦2,499</p>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1603808033192-082d6919d3e1?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product 5" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Leather Boots</h3>
       <p class="product-price">₦899</p>
      </div>
     </div>
     <div class="product-card tall">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1591561954557-26941169b49e?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product 6" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Wool Coat</h3>
       <p class="product-price">₦1,899</p>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1617038260897-41a1f14a8ca0?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product 7" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Gold Watch</h3>
       <p class="product-price">₦3,499</p>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1606760227091-3dd870d97f1d?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product 8" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Statement Ring</h3>
       <p class="product-price">₦749</p>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image-wrapper"><img src="https://images.unsplash.com/photo-1606760227091-3dd870d97f1d?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product 8" class="product-img">
       <div class="product-overlay"><button class="quick-view-btn">View</button>
       </div>
      </div>
      <div class="product-info">
       <h3 class="product-name">Statement Ring</h3>
       <p class="product-price">₦749</p>
      </div>
     </div>
    </div>
   </div><!-- Products In Stock Section -->
   <div class="stock-section">
    <h2 class="stock-title">In Stock Now</h2>
    <div class="stock-carousel">
     <div class="stock-track" id="stockTrack">
      <div class="stock-item"><img src="https://images.unsplash.com/photo-1565084888279-aca607ecce0c?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product" class="stock-img">
       <div class="stock-details">
        <h3 class="stock-product-name">Cashmere Sweater</h3>
        <p class="stock-price">₦899</p>
       </div>
      </div>
      <div class="stock-item"><img src="https://images.unsplash.com/photo-1600185365926-3a2ce3cdb9eb?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product" class="stock-img">
       <div class="stock-details">
        <h3 class="stock-product-name">Leather Sneakers</h3>
        <p class="stock-price">₦649</p>
       </div>
      </div>
      <div class="stock-item"><img src="https://images.unsplash.com/photo-1622434641406-a158123450f9?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product" class="stock-img">
       <div class="stock-details">
        <h3 class="stock-product-name">Silk Blouse</h3>
        <p class="stock-price">₦749</p>
       </div>
      </div>
      <div class="stock-item"><img src="https://images.unsplash.com/photo-1614676471928-2ed0ad1061a4?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product" class="stock-img">
       <div class="stock-details">
        <h3 class="stock-product-name">Crossbody Bag</h3>
        <p class="stock-price">₦1,199</p>
       </div>
      </div>
      <div class="stock-item"><img src="https://images.unsplash.com/photo-1509941943102-10c232535736?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product" class="stock-img">
       <div class="stock-details">
        <h3 class="stock-product-name">Denim Jacket</h3>
        <p class="stock-price">₦599</p>
       </div>
      </div>
      <div class="stock-item"><img src="https://images.unsplash.com/photo-1611312449408-fcece27cdbb7?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product" class="stock-img">
       <div class="stock-details">
        <h3 class="stock-product-name">Wool Trousers</h3>
        <p class="stock-price">₦799</p>
       </div>
      </div>
      <div class="stock-item"><img src="https://images.unsplash.com/photo-1581655353564-df123a1eb820?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product" class="stock-img">
       <div class="stock-details">
        <h3 class="stock-product-name">Evening Gown</h3>
        <p class="stock-price">₦2,299</p>
       </div>
      </div>
      <div class="stock-item"><img src="https://images.unsplash.com/photo-1520975867597-0af37a22e31e?auto=format&amp;fit=crop&amp;q=80&amp;w=800" alt="Product" class="stock-img">
       <div class="stock-details">
        <h3 class="stock-product-name">Oxford Shoes</h3>
        <p class="stock-price">₦799</p>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Product Panel Overlay -->
   <div class="panel-overlay" id="panelOverlay"></div><!-- Product Panel -->
   <div class="product-panel" id="productPanel">
    <div class="panelholder">
        <div class="panel-handle" id="panelHandle"></div>
    </div>
    <div class="panel-content" id="panelContent">
      <!-- Dynamic content will be loaded here -->
       
    </div>
   </div><!-- Success Message -->
   <div class="success-message" id="successMessage">
    <div class="success-message-title"></div>
    <div class="success-message-text"></div>
   </div><!-- Footer -->
   <footer class="footer">
    <div class="footer-content">
     <div class="footer-section">
      <h4 class="footer-heading">Customer Service</h4>
      <ul class="footer-links">
       <li><a href="#" target="_blank" rel="noopener noreferrer">Contact Us</a></li>
       <li><a href="#" target="_blank" rel="noopener noreferrer">Shipping &amp; Returns</a></li>
       <li><a href="#" target="_blank" rel="noopener noreferrer">Size Guide</a></li>
       <li><a href="#" target="_blank" rel="noopener noreferrer">Track Order</a></li>
      </ul>
     </div>
     <div class="footer-section">
      <h4 class="footer-heading">About Us</h4>
      <ul class="footer-links">
       <li><a href="#" target="_blank" rel="noopener noreferrer">Our Story</a></li>
       <li><a href="#" target="_blank" rel="noopener noreferrer">Careers</a></li>
       <li><a href="#" target="_blank" rel="noopener noreferrer">Sustainability</a></li>
       <li><a href="#" target="_blank" rel="noopener noreferrer">Press</a></li>
      </ul>
     </div>
     <div class="footer-section">
      <h4 class="footer-heading">Legal</h4>
      <ul class="footer-links">
       <li><a href="#" target="_blank" rel="noopener noreferrer">Privacy Policy</a></li>
       <li><a href="#" target="_blank" rel="noopener noreferrer">Terms of Service</a></li>
       <li><a href="#" target="_blank" rel="noopener noreferrer">Cookie Policy</a></li>
      </ul>
     </div>
     <div class="footer-section">
      <h4 class="footer-heading">Follow Us</h4>
      <div class="social-links"><a href="#" target="_blank" rel="noopener noreferrer" class="social-icon">
        <svg viewbox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
        </svg></a> <a href="#" target="_blank" rel="noopener noreferrer" class="social-icon">
        <svg viewbox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z" />
        </svg></a> <a href="#" target="_blank" rel="noopener noreferrer" class="social-icon">
        <svg viewbox="0 0 24 24" fill="currentColor"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z" />
        </svg></a>
      </div>
     </div>
    </div>
    <div class="footer-bottom">
     <p class="footer-copyright">© 2024 All Rights Reserved</p>
     <div class="footer-brand" id="footerBrand">
      MAMAG!
     </div>
    </div>
   </footer>
  </div>
  <script>
    /**
 * 1. CONFIGURATION & ELEMENT SDK
 */
const defaultConfig = {
    brand_name: 'MAMAG!',
    hero_title: 'New In',
    btn_her: 'For Her',
    btn_him: 'For Him',
    contact_text: '+ Contact Us',
    primary_bg: '#000000',
    secondary_surface: '#ffffff',
    text_color: '#ffffff',
    primary_action: '#1a1a1a',
    secondary_action: '#333333',
    font_family: 'Playfair Display',
    font_size: 16
};

// Global Global Variables
window.checkoutMethod = 'delivery'; 
window.isDropdownOpen = false;
window.deliveryRegions = [
    { name: "Lagos (Mainland)", price: 2500 },
    { name: "Lagos (Island)", price: 4000 },
    { name: "Abuja", price: 5000 },
    { name: "Port Harcourt", price: 5000 },
    { name: "Other Regions", price: 7000 }
];
window.selectedRegion = window.deliveryRegions[0];

async function onConfigChange(config) {
    const brandName = config.brand_name || defaultConfig.brand_name;
    const heroTitle = config.hero_title || defaultConfig.hero_title;
    const primaryBg = config.primary_bg || defaultConfig.primary_bg;
    const secondarySurface = config.secondary_surface || defaultConfig.secondary_surface;
    const textColor = config.text_color || defaultConfig.text_color;
    const primaryAction = config.primary_action || defaultConfig.primary_action;
    const fontFamily = config.font_family || defaultConfig.font_family;
    const fontSize = config.font_size || defaultConfig.font_size;

    document.documentElement.style.setProperty('--primary-bg', primaryBg);
    document.documentElement.style.setProperty('--secondary-surface', secondarySurface);
    document.documentElement.style.setProperty('--text-color', textColor);
    document.documentElement.style.setProperty('--primary-action', primaryAction);
    document.body.style.fontFamily = `${fontFamily}, Georgia, serif`;
    document.body.style.fontSize = `${fontSize}px`;

    document.getElementById('loadingLogo').textContent = brandName;
    document.getElementById('headerLogo').textContent = brandName;
    document.getElementById('heroLogo').textContent = brandName;
    document.getElementById('heroTitle').textContent = heroTitle;
    document.getElementById('btnHer').textContent = config.btn_her || defaultConfig.btn_her;
    document.getElementById('btnHim').textContent = config.btn_him || defaultConfig.btn_him;
    document.getElementById('contactText').textContent = config.contact_text || defaultConfig.contact_text;
    document.getElementById('footerBrand').textContent = brandName;
}

if (window.elementSdk) {
    window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
            recolorables: [
                { get: () => config.primary_bg || defaultConfig.primary_bg, set: (v) => { config.primary_bg = v; window.elementSdk.setConfig({ primary_bg: v }); } },
                { get: () => config.secondary_surface || defaultConfig.secondary_surface, set: (v) => { config.secondary_surface = v; window.elementSdk.setConfig({ secondary_surface: v }); } },
                { get: () => config.text_color || defaultConfig.text_color, set: (v) => { config.text_color = v; window.elementSdk.setConfig({ text_color: v }); } },
                { get: () => config.primary_action || defaultConfig.primary_action, set: (v) => { config.primary_action = v; window.elementSdk.setConfig({ primary_action: v }); } }
            ],
            fontEditable: { get: () => config.font_family || defaultConfig.font_family, set: (v) => { config.font_family = v; window.elementSdk.setConfig({ font_family: v }); } },
            fontSizeable: { get: () => config.font_size || defaultConfig.font_size, set: (v) => { config.font_size = v; window.elementSdk.setConfig({ font_size: v }); } }
        }),
        mapToEditPanelValues: (config) => new Map([
            ['brand_name', config.brand_name || defaultConfig.brand_name],
            ['hero_title', config.hero_title || defaultConfig.hero_title],
            ['btn_her', config.btn_her || defaultConfig.btn_her],
            ['btn_him', config.btn_him || defaultConfig.btn_him],
            ['contact_text', config.contact_text || defaultConfig.contact_text]
        ])
    });
}

/**
 * 2. INITIALIZATION & HEADER
 */
window.addEventListener('load', () => {
    setTimeout(() => {
        document.getElementById('loadingScreen').classList.add('hidden');
        document.getElementById('mainContent').classList.add('visible');
    }, 2000);
});

window.addEventListener('scroll', () => {
    const navbar = document.getElementById('navbar');
    const heroLogo = document.getElementById('heroLogo');
    if (window.scrollY > 50) {
        navbar.classList.add('scrolled');
        if(heroLogo) heroLogo.classList.add('slide-up');
    } else {
        navbar.classList.remove('scrolled');
        if(heroLogo) heroLogo.classList.remove('slide-up');
    }
});

/*** 3. STORIES / STATUS SYSTEM */// 1. Element Selectors
const statusViewer = document.getElementById('statusViewer'); 
const fullscreenImage = document.getElementById('fullscreenImage');
const fullscreenName = document.getElementById('fullscreenName');
const progressContainer = document.querySelector('.progress-container');
const closeBtn = document.getElementById('closeBtn');
const likeBtn = document.getElementById('likeBtn');
const saveBtn = document.getElementById('saveBtn');
const orderBtn = document.getElementById('orderBtn');

// 2. Configuration & Data
const IMAGE_DURATION = 5000; 
let currentIndex = 0;
let statusTimer = null;
let touchStartX = 0;
let touchEndX = 0;

const statusData = [
    { type: 'image', url: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?auto=format&fit=crop&q=80&w=2070', name: 'Spring Collection - ₦1,299' },
    { type: 'image', url: 'https://images.unsplash.com/photo-1539533018447-63fcce2678e3?auto=format&fit=crop&q=80&w=2070', name: 'Summer Essentials - ₦1,299' },
    { type: 'image', url: 'https://images.unsplash.com/photo-1483985988355-763728e1935b?auto=format&fit=crop&q=80&w=2070', name: 'Limited Edition - ₦1,299' },
    { type: 'image', url: 'https://images.unsplash.com/photo-1469334031218-e382a71b716b?auto=format&fit=crop&q=80&w=2070', name: 'New Arrivals - ₦1,299' },
    { type: 'image', url: 'https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?auto=format&fit=crop&q=80&w=2070', name: 'Spring Collection - ₦1,299' },
    { type: 'image', url: 'https://images.unsplash.com/photo-1539533018447-63fcce2678e3?auto=format&fit=crop&q=80&w=2070', name: 'Summer Essentials - ₦1,299' },
    { type: 'image', url: 'https://images.unsplash.com/photo-1483985988355-763728e1935b?auto=format&fit=crop&q=80&w=2070', name: 'Limited Edition - ₦1,299' },
    { type: 'image', url: 'https://images.unsplash.com/photo-1469334031218-e382a71b716b?auto=format&fit=crop&q=80&w=2070', name: 'New Arrivals - ₦1,299' }
];

// 3. Helper Functions
function initProgressBars() {
    progressContainer.innerHTML = '';
    statusData.forEach(() => {
        const bar = document.createElement('div');
        bar.classList.add('progress-bar');
        const fill = document.createElement('div');
        fill.classList.add('progress-fill');
        bar.appendChild(fill);
        progressContainer.appendChild(bar);
    });
}

function resetInteractionSidebar() {
    // Reset Like Button
    likeBtn.classList.remove('liked');
    likeBtn.querySelector('.interaction-label').textContent = 'Like';
    likeBtn.querySelector('svg').style.fill = 'none';

    // Reset Save Button
    saveBtn.classList.remove('saved');
    saveBtn.querySelector('.interaction-label').textContent = 'Save';
    saveBtn.querySelector('svg').style.fill = 'none';
}

function updateProgressBarUI(index) {
    const fills = document.querySelectorAll('.progress-fill');
    fills.forEach((fill, i) => {
        fill.style.transition = 'none';
        fill.style.width = i < index ? '100%' : '0%';
    });
}

function animateProgress(index, duration) {
    const fills = document.querySelectorAll('.progress-fill');
    const activeFill = fills[index];
    if (!activeFill) return;

    activeFill.getBoundingClientRect(); // Force reflow
    activeFill.style.transition = `width ${duration}ms linear`;
    activeFill.style.width = '100%';
}

// 4. Core Display Logic
function showStatus(index) {
    if (index < 0) return;
    if (index >= statusData.length) {
        closeStatus();
        return;
    }

    currentIndex = index;
    const data = statusData[currentIndex];
    
    clearTimeout(statusTimer);
    updateProgressBarUI(index);
    resetInteractionSidebar();
    
    fullscreenName.textContent = data.name;

    const existingVideo = document.getElementById('statusVideo');
    if (existingVideo) existingVideo.remove();

    if (data.type === 'video') {
        renderVideo(data.url);
    } else {
        renderImage(data.url);
    }
}

function renderImage(url) {
    fullscreenImage.style.display = 'block';
    fullscreenImage.src = url;
    
    animateProgress(currentIndex, IMAGE_DURATION);
    statusTimer = setTimeout(nextStatus, IMAGE_DURATION);
}

function renderVideo(url) {
    fullscreenImage.style.display = 'none';
    const video = document.createElement('video');
    video.id = 'statusVideo';
    video.src = url;
    video.autoplay = true;
    video.playsInline = true;
    video.classList.add('fullscreen-image');
    document.querySelector('.status-fullscreen').appendChild(video);

    video.onloadedmetadata = () => {
        animateProgress(currentIndex, video.duration * 1000);
    };
    video.onended = () => nextStatus();
}

function nextStatus() {
    showStatus(currentIndex + 1);
}

function prevStatus() {
    if (currentIndex > 0) showStatus(currentIndex - 1);
}

function closeStatus() {
    statusViewer.classList.remove('active');
    document.body.style.overflow = 'auto';
    clearTimeout(statusTimer);
    const video = document.getElementById('statusVideo');
    if (video) video.pause();
}

// 5. Touch & Swipe Logic
statusViewer.addEventListener('touchstart', (e) => {
    touchStartX = e.changedTouches[0].screenX;
}, {passive: true});

statusViewer.addEventListener('touchend', (e) => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
}, {passive: true});

function handleSwipe() {
    const threshold = 50;
    if (touchEndX < touchStartX - threshold) nextStatus(); // Swipe Left
    if (touchEndX > touchStartX + threshold) prevStatus(); // Swipe Right
}

// 6. Navigation & Interaction Event Listeners
document.querySelectorAll('.status-card').forEach((card, index) => {
    card.addEventListener('click', () => {
        initProgressBars();
        statusViewer.classList.add('active');
        document.body.style.overflow = 'hidden';
        showStatus(index);
        card.querySelector('.status-avatar-ring').classList.add('viewed');
    });
});

statusViewer.addEventListener('click', (e) => {
    // Stop navigation if clicking buttons
    if (e.target.closest('.interaction-sidebar') || 
        e.target.closest('.order-btn') || 
        e.target.closest('.close-btn')) return;

    const width = window.innerWidth;
    if (e.clientX < width * 0.3) {
        prevStatus();
    } else {
        nextStatus();
    }
});

closeBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    closeStatus();
});

likeBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    const isLiked = likeBtn.classList.toggle('liked');
    likeBtn.querySelector('.interaction-label').textContent = isLiked ? 'Liked' : 'Like';
    likeBtn.querySelector('svg').style.fill = isLiked ? 'red' : 'none';
});

saveBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    const isSaved = saveBtn.classList.toggle('saved');
    saveBtn.querySelector('.interaction-label').textContent = isSaved ? 'Saved' : 'Save';
    saveBtn.querySelector('svg').style.fill = isSaved ? 'yellow' : 'none';
});

orderBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    const statusNames = ['leather-handbag', 'silk-scarf', 'designer-sunglasses', 'evening-dress', 'leather-handbag', 'silk-scarf', 'designer-sunglasses', 'evening-dress'];
    const productToLoad = statusNames[currentIndex] || 'leather-handbag';

    closeStatus();
    loadProductPanel(productToLoad);
});



  const productData = {
      'leather-handbag': {
        name: 'Leather Handbag',
        price: '₦1,299,000',
        images: [
          'https://images.unsplash.com/photo-1591047139829-d91aecb6caea?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1548036328-c9fa89d128fa?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1566150905458-1bf1fc113f0d?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1590874103328-eac38a683ce7?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1564422170194-896b89110ef8?auto=format&fit=crop&q=80&w=800'
        ],
        sizes: ['S', 'M', 'L', 'XL'],
        stock: ['100'],
      },
      'silk-scarf': {
        name: 'Silk Scarf',
        price: '₦450,000',
        images: [
          'https://images.unsplash.com/photo-1624623278313-a930126a11c3?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1601924994987-69e26d50dc26?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1613521850668-5e4f6d55a1ec?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1590736969955-71cc94901144?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1591214369969-9c0c8e26f7c6?auto=format&fit=crop&q=80&w=800'
        ],
        sizes: ['One Size'],
        stock: ['100'],
      },
      'designer-sunglasses': {
        name: 'Designer Sunglasses',
        price: '₦599,000',
        images: [
          'https://images.unsplash.com/photo-1551107696-a4b0c5a0d9a2?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1511499767150-a48a237f0083?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1508296695146-257a814070b4?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1473496169904-658ba7c44d8a?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1583394838336-acd977736f90?auto=format&fit=crop&q=80&w=800'
        ],
        sizes: ['One Size'],
        stock: ['100'],
      },
      'evening-dress': {
        name: 'Evening Dress',
        price: '₦2,499,000',
        images: [
          'https://images.unsplash.com/photo-1460353581641-37baddab0fa2?auto=format&fit=crop&q=80&w=1200',
          'https://images.unsplash.com/photo-1566174053879-31528523f8ae?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1595777457583-95e059d581b8?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1539008835657-9e8e9680c956?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1566174053879-31528523f8ae?auto=format&fit=crop&q=80&w=800'
        ],
        sizes: ['XS', 'S', 'M', 'L', 'XL'],
        stock: ['100'],
      },
      'leather-boots': {
        name: 'Leather Boots',
        price: '₦899,000',
        images: [
          'https://images.unsplash.com/photo-1603808033192-082d6919d3e1?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1543163521-1bf539c55dd2?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1608256246200-53e635b5b65f?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1549062572-544a64fb0c56?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1605812860427-4024433a70fd?auto=format&fit=crop&q=80&w=800'
        ],
        sizes: ['5', '6', '7', '8', '9', '10', '11'],
        stock: ['100'],
      },
      'wool-coat': {
        name: 'Wool Coat',
        price: '₦1,899,000',
        images: [
          'https://images.unsplash.com/photo-1591561954557-26941169b49e?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1539533113208-f6df8cc8b543?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1591047139829-d91aecb6caea?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1544441893-675973e31985?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1548624313-c64a963097e2?auto=format&fit=crop&q=80&w=800'
        ],
        sizes: ['XS', 'S', 'M', 'L', 'XL'],
        stock: ['100'],
      },
      'gold-watch': {
        name: 'Gold Watch',
        price: '₦3,499,000',
        images: [
          'https://images.unsplash.com/photo-1617038260897-41a1f14a8ca0?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1524592094714-0f0654e20314?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1509941943102-10c232535736?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1622434641406-a158123450f9?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1611923134239-a8834dcbd3e5?auto=format&fit=crop&q=80&w=800'
        ],
        sizes: ['One Size'],
        stock: ['100'],
      },
      'statement-ring': {
        name: 'Statement Ring',
        price: '₦749,000',
        images: [
          'https://images.unsplash.com/photo-1606760227091-3dd870d97f1d?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1605100804763-247f67b3557e?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1515562141207-7a88fb7ce338?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1611591437281-460bfbe1220a?auto=format&fit=crop&q=80&w=800',
          'https://images.unsplash.com/photo-1603561596112-0a132b757442?auto=format&fit=crop&q=80&w=800'
        ],
        sizes: ['5', '6', '7', '8', '9'],
        stock: ['100'],
      }
    };


    // Categories Data - Women's Fashion
    const categoriesData = {
      'dresses': {
        name: 'Dresses',
        items: [
          {
            id: 'cocktail-dress',
            name: 'Cocktail Dress',
            price: '₦1,299,000',
            image: 'https://images.unsplash.com/photo-1566174053879-31528523f8ae?auto=format&fit=crop&q=80&w=800',
            images: [
              'https://images.unsplash.com/photo-1566174053879-31528523f8ae?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1595777457583-95e059d581b8?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1539008835657-9e8e9680c956?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1566174546031-51d9b063e5f8?auto=format&fit=crop&q=80&w=800'
            ],
            sizes: ['XS', 'S', 'M', 'L', 'XL'],
            stock: ['100'],
          },
          {
            id: 'maxi-dress',
            name: 'Maxi Dress',
            price: '₦899,000',
            image: 'https://images.unsplash.com/photo-1572804013309-59a88b7e92f1?auto=format&fit=crop&q=80&w=800',
            images: [
              'https://images.unsplash.com/photo-1572804013309-59a88b7e92f1?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1595777457583-95e059d581b8?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1588731247988-3092da1f5f83?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1545291730-faff8ca1d4b0?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1551803091-e20673f15770?auto=format&fit=crop&q=80&w=800'
            ],
            sizes: ['XS', 'S', 'M', 'L', 'XL'],
            stock: ['100'],
          },
          {
            id: 'wrap-dress',
            name: 'Wrap Dress',
            price: '₦749,000',
            image: 'https://images.unsplash.com/photo-1581044777550-4cfa60707c03?auto=format&fit=crop&q=80&w=800',
            images: [
              'https://images.unsplash.com/photo-1581044777550-4cfa60707c03?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1564257577802-18d88a351653?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1572804013309-59a88b7e92f1?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1596783074918-c84cb06531ca?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1559988152-389f5dfa771b?auto=format&fit=crop&q=80&w=800'
            ],
            sizes: ['XS', 'S', 'M', 'L', 'XL', 'XXL'],
            stock: ['100'],
          }
        ]
      },
      'shoes': {
        name: 'Shoes',
        items: [
          {
            id: 'heeled-sandals',
            name: 'Heeled Sandals',
            price: '₦649,000',
            image: 'https://images.unsplash.com/photo-1543163521-1bf539c55dd2?auto=format&fit=crop&q=80&w=800',
            images: [
              'https://images.unsplash.com/photo-1543163521-1bf539c55dd2?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1535043934128-cf0b28d52f95?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1566150905458-1bf1fc113f0d?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1626379953822-baec19c3accd?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1612902376960-4b86e1fe2f6a?auto=format&fit=crop&q=80&w=800'
            ],
            sizes: ['5', '6', '7', '8', '9', '10', '11'],
            stock: ['100'],
          },
          {
            id: 'ballet-flats',
            name: 'Ballet Flats',
            price: '₦449,000',
            image: 'https://images.unsplash.com/photo-1603487742131-4160ec999306?auto=format&fit=crop&q=80&w=800',
            images: [
              'https://images.unsplash.com/photo-1603487742131-4160ec999306?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1519718230655-72deb87c4f65?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1551115266-f8d38c4a9659?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1575537302964-96cd47c06b1b?auto=format&fit=crop&q=80&w=800',
              'https://images.unsplash.com/photo-1560343090-f0409e92791a?auto=format&fit=crop&q=80&w=800'
            ],
            sizes: ['5', '6', '7', '8', '9', '10', '11'],
            stock: ['100'],
          }
        ]
      }
    };

/*** 5. PANEL MANAGEMENT (Core UI)*/
    // Panel Management
    const panelOverlay = document.getElementById('panelOverlay');
    const productPanel = document.getElementById('productPanel');
    const panelContent = document.getElementById('panelContent');
    const panelHandle = document.getElementById('panelHandle');
    let selectedSize = null;
    let startY = 0;
    let currentY = 0;
    let isDragging = false;

    function openPanel() {
      panelOverlay.classList.add('active');
      productPanel.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closePanel() {
      panelOverlay.classList.remove('active');
      productPanel.classList.remove('active');
      document.body.style.overflow = 'auto';
      selectedSize = null;
    }

    function showSuccessMessage(title, text) {
      const successMessage = document.getElementById('successMessage');
      successMessage.querySelector('.success-message-title').textContent = title;
      successMessage.querySelector('.success-message-text').textContent = text;
      successMessage.classList.add('show');
      
      setTimeout(() => {
        successMessage.classList.remove('show');
      }, 1000);
    }



    // Panel close handlers
    panelOverlay.addEventListener('click', closePanel);

    // Drag to close on mobile
    panelHandle.addEventListener('touchstart', (e) => {
      startY = e.touches[0].clientY;
      isDragging = true;
    });

    panelHandle.addEventListener('touchmove', (e) => {
      if (!isDragging) return;
      currentY = e.touches[0].clientY;
      const diff = currentY - startY;
      if (diff > 0) {
        productPanel.style.transform = `translateY(${diff}px)`;
      }
    });

    panelHandle.addEventListener('touchend', () => {
      if (!isDragging) return;
      isDragging = false;
      const diff = currentY - startY;
      if (diff > 100) {
        closePanel();
      }
      productPanel.style.transform = '';
    });
/**
 * 6. CART & SHOPPING BAG
 */
let cartItems = [];
let cartCount = 0;

    function updateCartBadge() {
      const cartBadge = document.querySelector('.cart-badge');
      if (cartCount > 0) {
        if (!cartBadge) {
          const badge = document.createElement('div');
          badge.className = 'cart-badge show';
          badge.textContent = cartCount;
          document.querySelector('.nav-right .icon-btn:nth-child(1)').style.position = 'relative';
          document.querySelector('.nav-right .icon-btn:nth-child(1)').appendChild(badge);
        } else {
          cartBadge.textContent = cartCount;
          cartBadge.classList.add('show');
        }
      } else if (cartBadge) {
        cartBadge.classList.remove('show');
      }
    }

function addToCart(product, size) {
    const existing = cartItems.find(i => i.id === product.name && i.size === size);
    if (existing) existing.quantity++;
    else cartItems.push({ 
        id: product.name, 
        name: product.name, 
        price: product.price, 
        size, image: 
        product.images ? product.images[0] : product.image, 
        quantity: 1 }
    );
    
    cartCount++;
    updateCartBadge();
}

function removeFromCart(index) {
    cartCount -= cartItems[index].quantity;
    cartItems.splice(index, 1);
    updateCartBadge();
    loadCartPanel();
}

function updateCartQty(index, delta) {
    cartItems[index].quantity += delta;
    cartCount += delta;
    if (cartItems[index].quantity <= 0) {
        cartItems.splice(index, 1);
    }
    updateCartBadge();
    loadCartPanel();
}

function calculateTotal() {
    return cartItems.reduce((acc, item) => acc + (parseInt(item.price.replace(/\D/g, '')) * item.quantity), 0);
}

function loadCartPanel()    {
    if (cartItems.length === 0) {
        panelContent.innerHTML = `
        <div class="contact-content">
            <h2 class="contact-title">Shopping Bag</h2>
            <div class="cart-empty">
              <div class="cart-empty-icon">🛍️</div>
              <p>Your shopping bag is empty</p>
            </div>
          </div>
        `;
    } else {
        panelContent.innerHTML = `
            <div class="contact-content">
                <h2 class="contact-title">Shopping Bag</h2>
                ${cartItems.map((item, i) => `
                    <div class="cart-item" style="display:flex; gap:15px; margin-bottom:15px; border-bottom:1px solid #eee; padding-bottom:15px;">
                        <img src="${item.image}" style="width:90px; height:100px; object-fit:cover;  border-radius: 15px;">
                        <div style="flex:1">
                            <div style="font-weight:500;">${item.name}</div>
                            <div style="font-size:16px; color:#ccc;">Size: ${item.size}</div>
                            <div style="font-weight:500; margin-top:5px;">${item.price}</div>
                            <div style="display:flex; align-items:center; gap:10px; margin-top:10px;">
                                <button onclick="updateCartQty(${i},-1)" style="border:1px solid #ccc; width:25px; border-radius: 100px;">-</button>
                                <span>${item.quantity}</span>
                                <button onclick="updateCartQty(${i},1)" style="border:1px solid #ccc; width:25px; border-radius: 100px;">+</button>
                                <button onclick="removeFromCart(${i})" style="margin-left:auto; color:red; border:none; background:none; font-size:12px;">Remove</button>
                            </div>
                        </div>
                    </div>
                `).join('')}
                <div style="margin-top:20px; border-top:2px solid #000; padding-top:15px;">
                    <div style="display:flex; justify-content:space-between; font-weight:500;"><span>Total:</span><span>₦${calculateTotal().toLocaleString()}</span></div>
                    <button class="panel-btn primary" style="width:100%; margin-top:15px;" onclick="loadCheckoutPanel()">Checkout</button>
                </div>
            </div>
        `;
    }
    openPanel();
}

/**
 * 7. FIXED CHECKOUT SYSTEM (Toggle + Dropdown)
 */
window.setCheckoutMethod = function(method, e) {
    if (e) e.stopPropagation(); 
    window.checkoutMethod = method;
    window.isDropdownOpen = false;
    loadCheckoutPanel(); 
};

window.toggleRegionList = function(e) {
    if (e) {
        e.preventDefault();
        e.stopPropagation(); 
    }
    window.isDropdownOpen = !window.isDropdownOpen;
    loadCheckoutPanel();
};

window.pickRegionValue = function(name, price, e) {
    if (e) e.stopPropagation();
    window.selectedRegion = { name: name, price: price };
    window.isDropdownOpen = false;
    loadCheckoutPanel();
};

// Global click listener to close dropdowns
window.addEventListener('click', (e) => {
    if (window.isDropdownOpen && !e.target.closest('.custom-dropdown')) {
        window.isDropdownOpen = false;
        loadCheckoutPanel();
    }
});

function loadCheckoutPanel() {
    // 1. Safety Checks & Calculations
    const subtotal = typeof calculateTotal === 'function' ? calculateTotal() : 0;
    
    // Ensure window variables exist to prevent crashes
    window.checkoutMethod = window.checkoutMethod || 'delivery';
    window.selectedRegion = window.selectedRegion || { name: 'Select Region', price: 0 };
    window.deliveryRegions = window.deliveryRegions || [];

    const deliveryFee = window.checkoutMethod === 'delivery' ? window.selectedRegion.price : 0;
    const serviceCharge = subtotal * 0.036;
    const grandTotal = subtotal + deliveryFee + serviceCharge;

    panelContent.innerHTML = `
        <div class="contact-content">
            <h2 class="contact-title">Checkout</h2>
            
            <div class="contact-subtitle">Order Summary</div>
            <div class="checkout-summary-box" style="background: #000; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #333;">
                <div class="checkout-items">
                ${cartItems.map(item => `
                    <div class="checkout-item" style="display:flex; justify-content:space-between; font-size:14px; color: #fff;">
                        <span>${item.name} (size: ${item.size}) x${item.quantity}</span>
                        <span>${item.price.toLocaleString()}</span>
                    </div>
                `).join('')}
                </div>

                <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px; font-size: 14px; color: #bbb;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span>Subtotal:</span><span>₦${subtotal.toLocaleString()}</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span>Delivery:</span>
                        <span>${window.checkoutMethod === 'delivery' ? `₦${deliveryFee.toLocaleString()}` : '<span style="color:#27ae60; font-weight:bold;">FREE</span>'}</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                        <span>Service Charge (3.6%):</span><span>₦${serviceCharge.toLocaleString()}</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; border-top: 1px solid #444; padding-top: 10px; margin-top: 10px; font-weight: 700; font-size:16px; color: #fff;">
                        <span>Total:</span>
                        <span>₦${grandTotal.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}</span>
                    </div>
                </div> 
            </div>    

            <div class="method-toggle" style="display:flex; background:#eee; padding:4px; border-radius:50px; margin-bottom:25px; position:relative; cursor:pointer; height:45px; align-items:center;">
                <div style="position:absolute; top:4px; bottom:4px; width:calc(50% - 4px); background:#000; border-radius:50px; transition:0.3s; left:4px; transform:${window.checkoutMethod === 'pickup' ? 'translateX(100%)' : 'translateX(0)'}"></div>
                <div onclick="setCheckoutMethod('delivery', event)" style="flex:1; text-align:center; z-index:2; font-weight:600; font-size:12px; color:${window.checkoutMethod === 'delivery' ? '#fff' : '#666'}">DELIVERY</div>
                <div onclick="setCheckoutMethod('pickup', event)" style="flex:1; text-align:center; z-index:2; font-weight:600; font-size:12px; color:${window.checkoutMethod === 'pickup' ? '#fff' : '#666'}">PICKUP</div>
            </div>

            <form id="checkoutForm">
                ${window.checkoutMethod === 'delivery' ? `
                    <div class="form-group">
                        <label class="form-label">Delivery Region</label>
                        <div class="custom-dropdown" style="border:1px solid #ddd; background:#fff; position:relative; border-radius:20px 20px 0 0;">
                            <div onclick="toggleRegionList(event)" style="padding:12px; display:flex; justify-content:space-between; cursor:pointer; font-size:14px; color:#000;">
                                <span>${window.selectedRegion.name} (₦${window.selectedRegion.price.toLocaleString()})</span>
                                <span>▼</span>
                            </div>
                            <div style="display:${window.isDropdownOpen ? 'block' : 'none'}; color: #000; position:absolute; top:100%; left:-1px; right:-1px; background:#fff; border:1px solid #ddd; z-index:1000; max-height:150px; border-radius: 0 0 20px 20px; overflow-y:auto; box-shadow:0 10px 20px rgba(0,0,0,0.1);">
                                ${window.deliveryRegions.map(r => `
                                    <div onclick="pickRegionValue('${r.name}', ${r.price}, event)" style="padding:12px; border-bottom:1px solid #eee; font-size:13px; cursor:pointer;">${r.name} - ₦${r.price.toLocaleString()}</div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                    <div class="form-group"><label class="form-label">Street Address</label><input type="text" class="form-input" required></div>
                    <div class="form-group"><label class="form-label">Full Name</label><input type="text" id="checkoutName" class="form-input" required></div>
                    <div class="form-group"><label class="form-label">Email</label><input type="email" id="checkoutMail" class="form-input" required></div>
                    <div class="form-group"><label class="form-label">Phone Number</label><input type="tel" id="checkoutPhone" class="form-input" required></div>
                ` : `
                    <div style="background:#000; padding:15px; border-radius:8px; margin-bottom:20px; font-size:13px; color:#ffff4d;">
                      <strong style="font-weight: 500; color: #fff;">Pickup Location:</strong>
                      <br>MAMAG CLOTHING STORE, Lagos Island, Lagos.<br> Phone: 09018654747
                    </div>
                    <div class="form-group"><label class="form-label">Full Name</label><input type="text" class="form-input" required></div>
                    <div class="form-group"><label class="form-label">Phone Number</label><input type="tel"  class="form-input" required></div>
                    <div class="form-group"><label class="form-label">Email</label><input type="email" id="" class="form-input" required></div>

                `}
                
                <div style="border-top:1px solid #eee; padding-top:15px; margin-top:15px;">
                    <div style="display:flex; justify-content:space-between; font-weight:500; font-size:18px; color: #fff;">
                        <span>Total to Pay:</span>
                        <span>₦${grandTotal.toLocaleString()}</span>
                    </div>
                </div>
                <button type="submit" class="panel-btn primary" style="border:2px solid #fff; width:100%; margin-top:20px; background:#000; color:#fff; padding:15px; border-radius:100px; cursor:pointer;">Pay</button>
            </form>
        </div>
    `;

    // Re-attach the event listener because innerHTML wipes old ones
    document.getElementById('checkoutForm').addEventListener('submit', (e) => {
        e.preventDefault();
        if(typeof closePanel === 'function') closePanel();
        if(typeof showSuccessMessage === 'function') showSuccessMessage('Order Confirmed!', 'Your items are on the way.');
        cartItems = []; 
        if(typeof updateCartBadge === 'function') updateCartBadge();
    });

    if(typeof openPanel === 'function') openPanel();
}
/**
 * 8. AUTH & ACCOUNT MANAGEMENT
 */
let isLoggedIn = false;
let currentUser = {
    name: '',
    email: '',
    walletBalance: 2500000,
    addresses: [{ label: 'Home', street: '12 Luxury Way, Lagos' }],
    paymentMethods: [{ lastFour: '4242', expiry: '12/26' }]
};

function loadAuthPanel()    {
    panelContent.innerHTML = `
        <div class="contact-content">
            <h2 class="contact-title">Account</h2>
            <div style="display:flex; gap:10px; margin-bottom:30px;">
                <button class="panel-btn primary" style="flex:1" onclick="loadLoginForm()">Login</button>
                <button class="panel-btn secondary" style="flex:1" onclick="loadSignupForm()">Sign Up</button>
            </div>
        </div>
    `;
    openPanel();
}

function loadLoginForm()    {
    panelContent.innerHTML = `
        <div class="contact-content">
            <h2 class="contact-title">Login</h2>
            <form id="loginForm">
                <div class="form-group"><label class="form-label">Email</label><input type="email" id="lEmail" class="form-input" required></div>
                <div class="form-group"><label class="form-label">Password</label><input type="password" class="form-input" required></div>
                <button type="submit" class="panel-btn primary" style="width:100%">Login</button>
            </form>
        </div>
    `;
    document.getElementById('loginForm').addEventListener('submit', (e) => {
        e.preventDefault();
        isLoggedIn = true;
        currentUser.email = document.getElementById('lEmail').value;
        currentUser.name = currentUser.email.split('@')[0];
        closePanel();
        showSuccessMessage('Welcome!', `Logged in as ${currentUser.name}`);
    });
}

  function loadSignupForm() {
      panelContent.innerHTML = `
        <div class="auth-form-container">
          <h2 class="auth-form-title">Sign Up</h2>
          <form id="signupForm">
            <div class="form-group">
              <label class="form-label" for="signupName">Full Name</label>
              <input type="text" id="signupName" class="form-input" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="signupEmail">Email Address</label>
              <input type="email" id="signupEmail" class="form-input" required>
            </div>

            <div class="form-group">
              <label class="form-label" for="signupPhone">Phone Number</label>
              <input type="phone" id="signupPhone" class="form-input" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="signupPassword">Password</label>
              <input type="password" id="signupPassword" class="form-input" required minlength="8">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="signupConfirm">Confirm Password</label>
              <input type="password" id="signupConfirm" class="form-input" required>
            </div>

            <button type="submit" class="auth-submit-btn">Create Account</button>
            <button type="button" class="auth-back-btn" onclick="loadAuthPanel()">Back</button>
          </form>
        </div>
      `;

      document.getElementById('signupForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const password = document.getElementById('signupPassword').value;
        const confirm = document.getElementById('signupConfirm').value;
        
        if (password !== confirm) {
          showSuccessMessage('Error', 'Passwords do not match');
          return;
        }
        
        const name = document.getElementById('signupName').value;
        const email = document.getElementById('signupEmail').value;
        
        // Set user data
        isLoggedIn = true;
        currentUser.name = name;
        currentUser.email = email;
        currentUser.walletBalance = 0.00; // New users start with 0 balance
        
        closePanel();
        showSuccessMessage('Account Created!', 'Welcome to MAMAG');
      });
    }
 
 
    function loadProfilePanel() {
      const addressesHTML = currentUser.addresses.length > 0 
        ? currentUser.addresses.map((addr, index) => `
            <div class="info-card">
              <div class="info-card-content">
                <strong>${addr.label}</strong><br>
                ${addr.street}<br>
                ${addr.city}, ${addr.zip}
              </div>
              <div class="info-card-actions">
                <button class="info-card-btn" onclick="editAddress(${index})">Edit</button>
                <button class="info-card-btn delete" onclick="deleteAddress(${index})">Delete</button>
              </div>
            </div>
          `).join('')
        : '<div class="empty-state">No delivery addresses added yet</div>';

      const paymentMethodsHTML = currentUser.paymentMethods.length > 0
        ? currentUser.paymentMethods.map((pm, index) => `
            <div class="payment-method-card">
              <div class="payment-method-info">
                <div class="payment-method-icon">${pm.type === 'visa' ? '💳' : pm.type === 'mastercard' ? '💳' : '💳'}</div>
                <div class="payment-method-details">
                  <div class="payment-method-number">•••• •••• •••• ${pm.lastFour}</div>
                  <div class="payment-method-expiry">Expires ${pm.expiry}</div>
                </div>
              </div>
              <button class="info-card-btn delete" onclick="deletePaymentMethod(${index})">Remove</button>
            </div>
          `).join('')
        : '<div class="empty-state">No payment methods added yet</div>';

      panelContent.innerHTML = `
        <div class="profile-container">
          <div class="profile-header">
            <div class="profile-avatar">MG</div>
            <div class="profile-name">${currentUser.name}</div>
            <div class="profile-email">${currentUser.email}</div>
          </div>


          <div class="profile-section">
            <div class="profile-section-title">
              Payment Methods
              <button class="add-btn" onclick="showAddPaymentForm()">+</button>
            </div>
            <div id="paymentMethodsContainer">
              ${paymentMethodsHTML}
            </div>
          </div>

          <div class="profile-section">
            <div class="profile-section-title">
              Delivery Addresses
              <button class="add-btn" onclick="showAddAddressForm()">+</button>
            </div>
            <div id="addressesContainer">
              ${addressesHTML}
            </div>
          </div>

          <div class="profile-actions">
            <button class="profile-action-btn secondary" onclick="editProfile()">Update Profile</button>
            <button class="profile-action-btn secondary" onclick="logoutUser()">Logout</button>
            <button class="profile-action-btn danger" onclick="deleteAccount()">Delete Account</button>
          </div>
        </div>
      `;

      openPanel();
    }
/**
 * 9. SEARCH & CATEGORIES
 */
function loadSearchPanel() {
    panelContent.innerHTML = `
       <div class="search-container">
          <div class="search-input-wrapper">
            <input type="text" class="search-input" placeholder="Search for products..." id="searchInput">
            <button class="search-icon-btn" id="searchBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="11" cy="11" r="8"/>
                <path d="M21 21l-4.35-4.35"/>
              </svg>
            </button>
          </div>

          <div class="contact-subtitle">Trending Searches</div>
          <div class="search-tags">
            <div class="search-tag">Dresses</div>
            <div class="search-tag">Handbags</div>
            <div class="search-tag">Shoes</div>
            <div class="search-tag">Accessories</div>
            <div class="search-tag">New Arrivals</div>
            <div class="search-tag">Sale Items</div>
          </div>

          <div class="contact-subtitle">Quick Search</div>
          <ul class="quick-search-list">
            <li class="quick-search-item">
              <span class="quick-search-icon">👗</span>
              <span class="quick-search-text">Women's Clothing</span>
            </li>
            <li class="quick-search-item">
              <span class="quick-search-icon">👠</span>
              <span class="quick-search-text">Footwear</span>
            </li>
            <li class="quick-search-item">
              <span class="quick-search-icon">👜</span>
              <span class="quick-search-text">Bags & Accessories</span>
            </li>
            <li class="quick-search-item">
              <span class="quick-search-icon">💍</span>
              <span class="quick-search-text">Jewelry</span>
            </li>
            <li class="quick-search-item">
              <span class="quick-search-icon">🕶️</span>
              <span class="quick-search-text">Eyewear</span>
            </li>
          </ul>
        </div>
    `;
    openPanel();
}

  function loadCategoryPanel(categoryId) {
      const category = categoriesData[categoryId];
      if (!category) return;

      panelContent.innerHTML = `
        <div class="category-panel-header">
          <div class="category-panel-title">${category.name}</div>
          <div class="category-panel-subtitle">${category.items.length} Items Available</div>
        </div>
        <div class="category-list">
          ${category.items.map(item => `
            <div class="category-item" data-item-id="${item.id}">
              <img src="${item.image}" class="category-item-image" alt="${item.name}">
              <div class="category-item-content">
                <div class="category-item-info">
                  <div class="category-item-name">${item.name}</div>
                  <div class="category-item-price">${item.price}</div>
                </div>
                <div class="category-item-arrow">→</div>
              </div>
            </div>
          `).join('')}
        </div>
      `;

      const categoryItems = panelContent.querySelectorAll('.category-item');
      categoryItems.forEach(item => {
        item.addEventListener('click', () => {
          const itemId = item.dataset.itemId;
          const categoryItem = category.items.find(i => i.id === itemId);
          if (categoryItem) {
            loadProductPanelFromCategory(categoryItem);
          }
        });
      });

      openPanel();
    }

    function loadProductPanel(productId) {
      const product = productData[productId];
      if (!product) return;

      selectedSize = null;

      panelContent.innerHTML = `
        <img src="${product.images[0]}" class="panel-main-image" id="panelMainImage" alt="${product.name}">
        <div class="panel-thumbnails">
          ${product.images.map((img, index) => `
            <img src="${img}" class="panel-thumbnail ${index === 0 ? 'selected' : ''}" alt="Thumbnail" data-index="${index}">
          `).join('')}
        </div>
        <h3 class="panel-product-name">${product.name}</h3>
        <p class="panel-product-price">${product.price}</p>
        
        <div class="panel-section-title">Select Size</div>
        <div class="size-options">
          ${product.sizes.map(size => `
            <button class="size-btn" data-size="${size}">${size}</button>
          `).join('')}
        </div>
        <div class="size-error" id="sizeError">Please select a size before ordering</div>
        
        <div class="panel-section-title">Stock</div>
        <p class="panel-description">${product.stock}</p>
        
        <div class="panel-actions">
          <button class="panel-btn primary" style="display: none;" id="orderNowBtn">Order Now</button>
          <button class="panel-btn secondary" id="addToCartBtn">Add to Bag</button>
        </div>
      `;

      // Thumbnail selection
      const thumbnails = panelContent.querySelectorAll('.panel-thumbnail');
      const mainImage = document.getElementById('panelMainImage');
      
      thumbnails.forEach(thumb => {
        thumb.addEventListener('click', () => {
          thumbnails.forEach(t => t.classList.remove('selected'));
          thumb.classList.add('selected');
          mainImage.src = thumb.src;
        });
      });

      // Size selection
      const sizeButtons = panelContent.querySelectorAll('.size-btn');
      sizeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          sizeButtons.forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          selectedSize = btn.dataset.size;
          document.getElementById('sizeError').classList.remove('show');
        });
      });

      // Order and Add to Cart
      document.getElementById('orderNowBtn').addEventListener('click', () => {
        if (!selectedSize) {
          document.getElementById('sizeError').classList.add('show');
          return;
        }
        closePanel();
        showSuccessMessage('Order Placed!', `${product.name} (Size: ${selectedSize}) will be shipped soon`);
      });

      document.getElementById('addToCartBtn').addEventListener('click', () => {
        if (!selectedSize) {
          document.getElementById('sizeError').classList.add('show');
          return;
        }
        
        // Create product object for cart
        const cartProduct = {
          id: productId,
          name: product.name,
          price: product.price,
          images: product.images
        };
        
        addToCart(cartProduct, selectedSize);
        closePanel();
        showSuccessMessage('Added to Cart!', `${product.name} has been added to bag`);
      });

      openPanel();
    }


    function loadProductPanelFromCategory(item) {
      selectedSize = null;

      panelContent.innerHTML = `
        <img src="${item.images[0]}" class="panel-main-image" id="panelMainImage" alt="${item.name}">
        <div class="panel-thumbnails">
          ${item.images.map((img, index) => `
            <img src="${img}" class="panel-thumbnail ${index === 0 ? 'selected' : ''}" alt="Thumbnail" data-index="${index}">
          `).join('')}
        </div>
        <h3 class="panel-product-name">${item.name}</h3>
        <p class="panel-product-price">${item.price}</p>
        
        <div class="panel-section-title">Select Size</div>
        <div class="size-options">
          ${item.sizes.map(size => `
            <button class="size-btn" data-size="${size}">${size}</button>
          `).join('')}
        </div>
        <div class="size-error" id="sizeError">Please select a size before ordering</div>
        
        
        
        <div class="panel-actions">
          <button class="panel-btn primary" style="display: none;" id="orderNowBtn">Order Now</button>
          <button class="panel-btn secondary" id="addToCartBtn">Add to Bag</button>
        </div>
      `;

      // Thumbnail selection
      const thumbnails = panelContent.querySelectorAll('.panel-thumbnail');
      const mainImage = document.getElementById('panelMainImage');
      
      thumbnails.forEach(thumb => {
        thumb.addEventListener('click', () => {
          thumbnails.forEach(t => t.classList.remove('selected'));
          thumb.classList.add('selected');
          mainImage.src = thumb.src;
        });
      });

      // Size selection
      const sizeButtons = panelContent.querySelectorAll('.size-btn');
      sizeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          sizeButtons.forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          selectedSize = btn.dataset.size;
          document.getElementById('sizeError').classList.remove('show');
        });
      });

      // Order and Add to Cart
      document.getElementById('orderNowBtn').addEventListener('click', () => {
        if (!selectedSize) {
          document.getElementById('sizeError').classList.add('show');
          return;
        }
        closePanel();
        showSuccessMessage('Order Placed!', `${item.name} (Size: ${selectedSize}) will be shipped soon`);
      });

      document.getElementById('addToCartBtn').addEventListener('click', () => {
        if (!selectedSize) {
          document.getElementById('sizeError').classList.add('show');
          return;
        }
        
        // Create product object for cart
        const cartProduct = {
          id: item.id,
          name: item.name,
          price: item.price,
          images: item.images
        };
        
        addToCart(cartProduct, selectedSize);
        closePanel();
        showSuccessMessage('Added to Cart!', `${item.name} (Size: ${selectedSize}) has been added`);
      });
    }

 function showAddPaymentForm() {
      const container = document.getElementById('paymentMethodsContainer');
      container.innerHTML = `
        <div class="add-form">
          <div class="add-form-title">Add Payment Method</div>
          <form id="addPaymentForm">
            <div class="form-group">
              <label class="form-label" for="cardNumber">Card Number</label>
              <input type="text" id="cardNumber" class="form-input" maxlength="16" required placeholder="1234567812345678">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="cardExpiry">Expiry Date</label>
              <input type="text" id="cardExpiry" class="form-input" placeholder="MM/YY" maxlength="5" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="cardCVV">CVV</label>
              <input type="text" id="cardCVV" class="form-input" maxlength="3" required placeholder="123">
            </div>

            <div style="display: flex; gap: 10px;">
              <button type="submit" class="panel-btn primary" style="flex: 1;">Add Card</button>
              <button type="button" class="panel-btn secondary" style="flex: 1;" onclick="loadProfilePanel()">Cancel</button>
            </div>
          </form>
        </div>
      ` + (currentUser.paymentMethods.length > 0 
          ? currentUser.paymentMethods.map((pm, index) => `
              <div class="payment-method-card">
                <div class="payment-method-info">
                  <div class="payment-method-icon">💳</div>
                  <div class="payment-method-details">
                    <div class="payment-method-number">•••• •••• •••• ${pm.lastFour}</div>
                    <div class="payment-method-expiry">Expires ${pm.expiry}</div>
                  </div>
                </div>
                <button class="info-card-btn delete" onclick="deletePaymentMethod(${index})">Remove</button>
              </div>
            `).join('')
          : '');

      document.getElementById('addPaymentForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const cardNumber = document.getElementById('cardNumber').value;
        const expiry = document.getElementById('cardExpiry').value;
        
        currentUser.paymentMethods.push({
          type: 'visa',
          lastFour: cardNumber.slice(-4),
          expiry: expiry
        });
        
        showSuccessMessage('Card Added!', 'Payment method added successfully');
        loadProfilePanel();
      });
    }    
    
    function deletePaymentMethod(index) {
      currentUser.paymentMethods.splice(index, 1);
      showSuccessMessage('Card Removed', 'Payment method has been removed');
      loadProfilePanel();
    }

    function showAddAddressForm() {
      const container = document.getElementById('addressesContainer');
      container.innerHTML = `
        <div class="add-form">
          <div class="add-form-title">Add Delivery Address</div>
          <form id="addAddressForm">
            <div class="form-group">
              <label class="form-label" for="addressLabel">Address Label</label>
              <input type="text" id="addressLabel" class="form-input" required placeholder="Home, Office, etc.">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="addressStreet">Street Address</label>
              <input type="text" id="addressStreet" class="form-input" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="addressCity">City</label>
              <input type="text" id="addressCity" class="form-input" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="addressZip">ZIP Code</label>
              <input type="text" id="addressZip" class="form-input" required>
            </div>

            <div style="display: flex; gap: 10px;">
              <button type="submit" class="panel-btn primary" style="flex: 1;">Add Address</button>
              <button type="button" class="panel-btn secondary" style="flex: 1;" onclick="loadProfilePanel()">Cancel</button>
            </div>
          </form>
        </div>
      ` + (currentUser.addresses.length > 0 
          ? currentUser.addresses.map((addr, index) => `
              <div class="info-card">
                <div class="info-card-content">
                  <strong>${addr.label}</strong><br>
                  ${addr.street}<br>
                  ${addr.city}, ${addr.zip}
                </div>
                <div class="info-card-actions">
                  <button class="info-card-btn" onclick="editAddress(${index})">Edit</button>
                  <button class="info-card-btn delete" onclick="deleteAddress(${index})">Delete</button>
                </div>
              </div>
            `).join('')
          : '');

      document.getElementById('addAddressForm').addEventListener('submit', (e) => {
        e.preventDefault();
        
        currentUser.addresses.push({
          label: document.getElementById('addressLabel').value,
          street: document.getElementById('addressStreet').value,
          city: document.getElementById('addressCity').value,
          zip: document.getElementById('addressZip').value
        });
        
        showSuccessMessage('Address Added!', 'Delivery address saved successfully');
        loadProfilePanel();
      });
    }

    function editAddress(index) {
      const addr = currentUser.addresses[index];
      const container = document.getElementById('addressesContainer');
      
      container.innerHTML = `
        <div class="add-form">
          <div class="add-form-title">Edit Delivery Address</div>
          <form id="editAddressForm">
            <div class="form-group">
              <label class="form-label" for="addressLabel">Address Label</label>
              <input type="text" id="addressLabel" class="form-input" value="${addr.label}" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="addressStreet">Street Address</label>
              <input type="text" id="addressStreet" class="form-input" value="${addr.street}" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="addressCity">City</label>
              <input type="text" id="addressCity" class="form-input" value="${addr.city}" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="addressZip">ZIP Code</label>
              <input type="text" id="addressZip" class="form-input" value="${addr.zip}" required>
            </div>

            <div style="display: flex; gap: 10px;">
              <button type="submit" class="panel-btn primary" style="flex: 1;">Save Changes</button>
              <button type="button" class="panel-btn secondary" style="flex: 1;" onclick="loadProfilePanel()">Cancel</button>
            </div>
          </form>
        </div>
      ` + currentUser.addresses.filter((_, i) => i !== index).map((addr, i) => `
          <div class="info-card">
            <div class="info-card-content">
              <strong>${addr.label}</strong><br>
              ${addr.street}<br>
              ${addr.city}, ${addr.zip}
            </div>
            <div class="info-card-actions">
              <button class="info-card-btn" onclick="editAddress(${i < index ? i : i + 1})">Edit</button>
              <button class="info-card-btn delete" onclick="deleteAddress(${i < index ? i : i + 1})">Delete</button>
            </div>
          </div>
        `).join('');

      document.getElementById('editAddressForm').addEventListener('submit', (e) => {
        e.preventDefault();
        
        currentUser.addresses[index] = {
          label: document.getElementById('addressLabel').value,
          street: document.getElementById('addressStreet').value,
          city: document.getElementById('addressCity').value,
          zip: document.getElementById('addressZip').value
        };
        
        showSuccessMessage('Address Updated!', 'Changes saved successfully');
        loadProfilePanel();
      });
    }

    function deleteAddress(index) {
      currentUser.addresses.splice(index, 1);
      showSuccessMessage('Address Deleted', 'Delivery address has been removed');
      loadProfilePanel();
    }

    function editProfile() {
      panelContent.innerHTML = `
        <div class="profile-container">
          <h2 class="contact-title">Update Profile</h2>
          <form id="editProfileForm">
            <div class="form-group">
              <label class="form-label" for="profileName">Full Name</label>
              <input type="text" id="profileName" class="form-input" value="${currentUser.name}" required>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="profileEmail">Email Address</label>
              <input type="email" id="profileEmail" class="form-input" value="${currentUser.email}" required>
            </div>

            <button type="submit" class="profile-action-btn primary">Save Changes</button>
            <button type="button" class="profile-action-btn secondary" onclick="loadProfilePanel()">Cancel</button>
          </form>
        </div>
      `;

      document.getElementById('editProfileForm').addEventListener('submit', (e) => {
        e.preventDefault();
        currentUser.name = document.getElementById('profileName').value;
        currentUser.email = document.getElementById('profileEmail').value;
        showSuccessMessage('Profile Updated!', 'Your information has been saved');
        loadProfilePanel();
      });
    }

    function logoutUser() {
      isLoggedIn = false;
      currentUser = {
        name: '',
        email: '',
        addresses: [],
        paymentMethods: [],
        walletBalance: 0
      };
      closePanel();
      showSuccessMessage('Logged Out', 'You have been successfully logged out');
    }

    function deleteAccount() {
      panelContent.innerHTML = `
        <div class="profile-container">
          <h2 class="contact-title">Delete Account</h2>
          <p style="text-align: center; color: #ff4444; margin-bottom: 30px; font-weight: 600;">
            This action cannot be undone!
          </p>
          <p style="text-align: center; color: #666; margin-bottom: 30px;">
            Are you sure you want to delete your account? All your data, wallet balance, and saved information will be permanently removed.
          </p>
          <div style="display: flex; flex-direction: column; gap: 10px;">
            <button class="profile-action-btn danger" onclick="confirmDeleteAccount()">Yes, Delete My Account</button>
            <button class="profile-action-btn secondary" onclick="loadProfilePanel()">Cancel</button>
          </div>
        </div>
      `;
    }

    function confirmDeleteAccount() {
      isLoggedIn = false;
      currentUser = {
        name: '',
        email: '',
        addresses: [],
        paymentMethods: [],
        walletBalance: 0
      };
      closePanel();
      showSuccessMessage('Account Deleted', 'Your account has been permanently deleted');
    }    
/**
 * 10. GLOBAL LISTENERS & NAVIGATION
 */
// Contact
document.querySelector('.nav-left').addEventListener('click', () => {
    panelContent.innerHTML = `
    <div class="  contact-content">
      <h2 class="contact-title">Contact</h2>
      <p>Tel: +234 800 123 4567<br>Email: support@mamag.com</p>
      </div>
      `;
    openPanel();
});

// Icons
const iconBtns = document.querySelectorAll('.icon-btn');
iconBtns[0].addEventListener('click', loadCartPanel); // Shopping Bag
iconBtns[1].addEventListener('click', () => isLoggedIn ? loadProfilePanel() : loadAuthPanel()); // Account
iconBtns[2].addEventListener('click', loadSearchPanel); // Search

// Category Grid Clicks
document.querySelectorAll('.stock-item').forEach((item, idx) => {
    item.addEventListener('click', () => {
        const cats = ['dresses','shoes','dresses','shoes','dresses','shoes','dresses','shoes'];
        loadCategoryPanel(cats[idx]);
    });
});

// Quick View Clicks
document.addEventListener('click', (e) => {
    if (e.target.classList.contains('quick-view-btn')) {
        const id = e.target.closest('.product-card').querySelector('.product-name').textContent.toLowerCase().replace(' ', '-');
        loadProductPanel(id);
    }
});

// Auto Scroll
    let scrollRequest;
  let isAutoScrolling = false;

  function step() {
    window.scrollBy(0, 4); // Adjust this number for speed

    // Continue if not at the bottom
    if ((window.innerHeight + window.scrollY) < document.body.scrollHeight) {
      scrollRequest = requestAnimationFrame(step);
    } else {
      stopAutoScroll();
    }
  }

  function stopAutoScroll() {
    cancelAnimationFrame(scrollRequest);
    isAutoScrolling = false;
    // Remove listeners once stopped to save resources
    window.removeEventListener('wheel', stopAutoScroll);
    window.removeEventListener('touchmove', stopAutoScroll);
    window.removeEventListener('keydown', stopAutoScroll);
  }

  document.getElementById('startScroll').addEventListener('click', (e) => {
    e.stopPropagation(); // Prevent the click itself from triggering a 'stop'
    if (isAutoScrolling) return;

    isAutoScrolling = true;
    scrollRequest = requestAnimationFrame(step);

    // Listen for manual intervention
    window.addEventListener('wheel', stopAutoScroll);
    window.addEventListener('touchmove', stopAutoScroll);
    window.addEventListener('keydown', stopAutoScroll);
  });

// Export functions for HTML usage
window.updateCartQty = updateCartQty;
window.removeFromCart = removeFromCart;
window.loadCheckoutPanel = loadCheckoutPanel;
window.loadCategoryPanel = loadCategoryPanel;
window.loadProductPanel = loadProductPanel;
window.loadLoginForm = loadLoginForm;
window.loadSignupForm = loadSignupForm;


  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9b9803dc9188bec8',t:'MTc2NzY2ODk1MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

